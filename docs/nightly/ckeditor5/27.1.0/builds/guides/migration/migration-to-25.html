<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Migration to v25.x - CKEditor 5 Documentation</title>
    <meta name="description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta name="twitter:card" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta name="twitter:site" content="@ckeditor">
    <meta property="og:title" content="Migration to v25.x - CKEditor 5 Documentation">
    <meta property="og:description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ckeditor.com/docs/ckeditor5/latest/builds/guides/migration/migration-to-25.html">
    <meta property="DC.language" content="en">
    <meta property="DC.publisher" content="CKSource">
    <meta property="DC.creator" content="CKEditor">
    <meta property="DC.title" content="Migration to v25.x - CKEditor 5 Documentation">
    <meta property="DC.format" content="text/html">
    <meta property="DC.type" content="Text">
    <meta property="DC.description" content="Learn how to install, integrate and configure CKEditor 5 Builds and how to work with CKEditor 5 Framework, customize it, create your own plugins and custom editors, change the UI or even bring your own UI to the editor. API reference and examples included.">
    <link rel="canonical" href="https://ckeditor.com/docs/ckeditor5/latest/builds/guides/migration/migration-to-25.html">
    <link rel="icon" type="image/png" href="../../../assets/img/favicons/16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="../../../assets/img/favicons/32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../assets/img/favicons/96x96.png" sizes="96x96">
    <link rel="apple-touch-icon" type="image/png" href="../../../assets/img/favicons/200x200.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
    <link rel="stylesheet" href="../../../../../assets/1.7.2/css/styles.css" type="text/css" media="all">
    <link rel="stylesheet" href="../../../assets/styles.css" type="text/css">
    <script>
      ( function() {
      	'use strict';
      	// Set up global variables;
      	if ( !window.umebrto ) {
      		window.umberto = {};
      	}
      	window.umberto.relativeAppPath = "../../../../../assets/1.7.2/scripts";
      
      	// Add app script
      	var el = document.createElement( 'script' );
      	el.setAttribute( 'async', 'async' );
      	el.setAttribute( 'defer', 'defer' );
      	if ( typeof Symbol === 'function' && typeof Symbol() === 'symbol' ) {
      		el.src = "../../../../../assets/1.7.2/scripts/app.js";
      	} else {
      		el.src = "../../../../../assets/1.7.2/scripts/app-polyfill.js";
      	}
      	document.getElementsByTagName( 'head' )[ 0 ].appendChild( el );
      
      	// Changing documentation theme enable it via `localStorage.setItem( 'theme', 'theme-dark' )`
      	if ( localStorage.getItem( 'theme' ) === 'theme-dark' ) {
      		document.getElementsByTagName( 'html' )[ 0 ].classList.add( 'theme-dark' );
      	}
      } )();
    </script>
    <script>if ( ["ckeditor5.github.io"].indexOf( location.hostname ) !== -1 ) {
      	function pageView() {
      		ga( 'send', 'pageview', location.pathname + location.search + location.hash );
      	}
      
      	(function( i, s, o, g, r, a, m ) {
      		i[ 'GoogleAnalyticsObject' ] = r;
      		i[ r ] = i[ r ] || function() {
      				(i[ r ].q = i[ r ].q || []).push( arguments )
      			}, i[ r ].l = 1 * new Date();
      		a = s.createElement( o ),
      			m = s.getElementsByTagName( o )[ 0 ];
      		a.async = 1;
      		a.src = g;
      		m.parentNode.insertBefore( a, m )
      	})( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
      
      	ga( 'create', {"trackingId":"UA-271067-19","cookieDomain":"ckeditor5.github.io"} );
      
      	pageView();
      
      	window.addEventListener( 'hashchange', pageView );
      }
    </script>
  <meta name="generator" content="Hexo 4.2.1"></head>
  <body>
    <header class="top" data-project="ckeditor5">
      <div class="header__main">
        <div class="header__main-rwd-button"><a href="#"><span></span><span></span><span></span></a></div>
        <div class="header__main-title"><a class="header__main-title-home" href="../../../../../index.html">CKEditor Ecosystem Documentation</a></div>
        <div class="top__search">
          <input class="top__search__box" type="text" id="docsearch_input" placeholder="Search in CKEditor 5">
          <div class="top__search__button"><img src="../../../../../assets/1.7.2/img/loupe.svg" alt="Search"></div>
        </div>
      </div>
      <div class="header__sub">
        <ul class="top__menu">
          <li class="top__menu-project-logo"><a href="../../../index.html">CKEditor 5</a></li>
          <li><a class="top__menu__item--active" href="../../index.html">Builds</a></li>
          <li><a href="../../../framework/index.html">Framework</a></li>
          <li><a href="../../../examples/index.html">Examples</a></li>
          <li><a href="../../../features/index.html">Features</a></li>
          <li><a class="top__menu__api" href="../../../api/index.html">API</a></li>
          <li><a class="top__menu-github-link" href="https://github.com/ckeditor/ckeditor5" target="_blank" title="CKEditor 5 on GitHub."><svg viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></li>
        </ul>
      </div>
      <div class="header__menu-rwd">
        <ul class="header__menu-rwd__projects">
          <li data-project="ckeditor5"><a href="../../../../latest/index.html">CKEditor 5</a>
            <ul class="tree header__menu-rwd__projects-pages">
              <li data-group="builds"><a href="../../index.html">Builds</a>
                <ul class="header__menu-rwd__projects-subpages">
                          <li>
                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Guides</span></div>
                            <ul class="tree__item-nested-list">
                                  <li><a href="../overview.html">
                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span></div></a></li>
                                  <li><a href="../whats-new.html">
                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">What's new?</span></div></a></li>
                                  <li><a href="../quick-start.html">
                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Quick start</span></div></a></li>
                                  <li><a href="../faq.html">
                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">FAQ</span></div></a></li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Integration</span></div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../integration/installation.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Installation</span></div></a></li>
                                          <li><a href="../integration/basic-api.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Basic API</span></div></a></li>
                                          <li><a href="../integration/configuration.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Configuration</span></div></a></li>
                                          <li><a href="../integration/saving-data.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting and saving data</span></div></a></li>
                                          <li><a href="../integration/installing-plugins.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Installing plugins</span></div></a></li>
                                          <li><a href="../integration/advanced-setup.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Advanced setup</span></div></a></li>
                                          <li><a href="../integration/csp.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Content Security Policy</span></div></a></li>
                                          <li><a href="../integration/content-styles.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Content styles</span></div></a></li>
                                          <li><a href="../integration/features-html-output-overview.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Features' HTML output</span></div></a></li>
                                          <li>
                                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Frameworks</span></div>
                                            <ul class="tree__item-nested-list">
                                                  <li><a href="../integration/frameworks/overview.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span></div></a></li>
                                                  <li><a href="../integration/frameworks/angular.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Angular component</span></div></a></li>
                                                  <li><a href="../integration/frameworks/react.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">React component</span></div></a></li>
                                                  <li><a href="../integration/frameworks/vuejs-v2.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Vue.js 2.x component</span></div></a></li>
                                                  <li><a href="../integration/frameworks/vuejs-v3.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Vue.js 3+ component</span></div></a></li>
                                                  <li><a href="../integration/frameworks/css.html">
                                                      <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">CSS frameworks</span></div></a></li>
                                            </ul>
                                          </li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Development</span></div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../development/custom-builds.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Custom builds</span></div></a></li>
                                          <li><a href="../development/plugins.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Plugins</span></div></a></li>
                                          <li><a href="../development/dll-builds.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">DLL builds</span></div></a></li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Migration</span></div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="migration-to-29.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration to v29.x</span></div></a></li>
                                          <li><a href="migration-to-27.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration to v27.x</span></div></a></li>
                                          <li><a href="migration-to-26.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration to v26.x</span></div></a></li>
                                          <li><a href="">
                                              <div class="tree__item__wrapper tree__item__wrapper--active"><span class="tree__item--guide tree__item__text">Migration to v25.x</span></div></a></li>
                                          <li><a href="migration-from-ckeditor-4.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration from CKEditor 4</span></div></a></li>
                                    </ul>
                                  </li>
                                  <li>
                                    <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Support</span></div>
                                    <ul class="tree__item-nested-list">
                                          <li><a href="../support/browser-compatibility.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Browser compatibility</span></div></a></li>
                                          <li><a href="../support/license-and-legal.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">License and legal</span></div></a></li>
                                          <li><a href="../support/getting-support.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting support</span></div></a></li>
                                          <li><a href="../support/reporting-issues.html">
                                              <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Reporting issues</span></div></a></li>
                                    </ul>
                                  </li>
                            </ul>
                          </li>
                </ul>
              </li>
              <li data-group="framework"><a href="../../../framework/index.html">Framework</a>
              </li>
              <li data-group="examples"><a href="../../../examples/index.html">Examples</a>
              </li>
              <li data-group="features"><a href="../../../features/index.html">Features</a>
              </li>
              <li data-group="api-reference"><a href="../../../api/index.html">API</a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </header>
    <main class="main">
      <section class="main__content formatted">
        <div class="main__content-inner">
          <div class="github-contrib"><a href="https://github.com/ckeditor/ckeditor5/blob/master/docs/builds/guides/migration/migration-to-25.md" target="_blank" rel="noopener" title="Contribute to this guide"><img src="../../../../../assets/1.7.2/img/edit.svg" alt="Contribute to this guide"></a>
          </div>
          <div class="rwd-breadcrumbs"><a href="../../../../../index.html">Home</a><span class="rwd-breadcrumbs__separator">/</span><a href="../../../index.html">CKEditor 5</a><span class="rwd-breadcrumbs__separator">/</span><a href="../../index.html">Builds</a>
          </div>
          <h1 class="main__content-title"><img src="../../../../../assets/1.7.2/img/book.svg" alt="guide">Migration to CKEditor 5 v25.0.0
          </h1><nav class="secondary-navigation"><h3>Table of contents</h3><ol><li><a href="#the-redesign-of-the-annotations-api">The redesign of the Annotations API</a></li><li><a href="#conceptual-and-architectural-changes">Conceptual and architectural changes</a></li><li><a href="#code-migration-examples">Code migration examples</a><ol><li><a href="#registering-and-activating-annotation-uis">Registering and activating annotation UIs</a></li><li><a href="#using-global-collection-of-annotations-and-active-annotations">Using  global collection of annotations and active annotations</a></li><li><a href="#creating-a-custom-annotations-ui">Creating a custom Annotations UI</a></li></ol></li></ol></nav>
<p>For the entire list of changes introduced in version 25.0.0, see the <a href="https://github.com/ckeditor/ckeditor5/blob/master/CHANGELOG.md#2500-2021-01-25" target="_blank" rel="noopener">changelog for CKEditor 5 v25.0.0</a>.</p>
<p>This migration guide enumerates the most important changes that require your attention when upgrading to CKEditor 5 v25.0.0 due to changes introduced in the <a href="https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/collaboration.html">collaboration features</a> and the redesign of the annotations API.</p>
<h2 id="the-redesign-of-the-annotations-api"><a class="headerlink" href="#the-redesign-of-the-annotations-api">#</a> The redesign of the Annotations API</h2>
<p>The entire annotations API was redesigned in order to support multiple annotation UIs at the same time. A good example of this is an idea of displaying <a href="https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/comments/comments.html">comments</a> in the <a href="https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/comments/comments-display-mode.html#wide-sidebar">sidebar</a> while showing suggestions from <a href="https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/track-changes/track-changes.html">track changes</a> in <a href="https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/comments/comments-display-mode.html#inline-balloons">inline balloons</a> when their corresponding suggestions are active. Due to that, some architectural changes were made and quite a lot of breaking changes were introduced with this release. See the migration guide below to check how to adapt to the changes.</p>
<h2 id="conceptual-and-architectural-changes"><a class="headerlink" href="#conceptual-and-architectural-changes">#</a> Conceptual and architectural changes</h2>
<p>The new annotations API allows for activating (attaching) multiple annotation UIs at the same time. To allow multiple UIs at the same time, the annotation filtering function must be registered during the annotation UI activation. Though, still, one annotation can be handled only by one annotation UI at the same time.</p>
<p>The new annotations API allows for setting multiple active annotations at the same time (max one per each annotation UI), so at some point more than one annotation can be active for various annotation UIs.</p>
<p>An annotation UI is now activated with its own collection of filtered annotations and became responsible for reacting to more events. This allows for more customization possibilities, however, unfortunately, it comes with more code needed to be written for the custom annotation UI class. After the changes, an annotation UI is responsible for:</p>
<ul>
<li>Displaying the annotation.</li>
<li>Marking the annotation as active when it should be activated and propagating this change via an observable property.</li>
<li>Reacting to editor events (though this is planned to be changed and simplified in the future).</li>
<li>Reacting to focus changes in the annotation collection.</li>
<li>Handling newly added and removed annotations.</li>
<li>Handling the annotation activation and deactivation from external places via the <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotationsuis-AnnotationsUI.html#function-setActiveAnnotation"><code>setActiveAnnotation()</code></a> method.</li>
</ul>
<p>The existing <code>Annotations</code> class was split to the new <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotations-Annotations.html"><code>Annotations</code></a> class, which is a global collection of annotations, and the new <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotationsuis-AnnotationsUIs.html"><code>AnnotationsUIs</code></a> class, which is mainly responsible for registering and activating annotation UIs.</p>
<p>In place where the <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_view_annotationview-AnnotationView.html"><code>AnnotationView</code></a> had been used, the new <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotations-Annotations.html"><code>Annotations</code></a>  class instance is used and it exposes mainly the following properties:</p>
<ul>
<li><a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotation-Annotation.html#member-target"><code>target</code></a> &#x2013; The target element to which the annotation should be bound. It can be a <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_utils_dom_rect-Rect.html"><code>Rect</code></a> instance or an HTML Element.</li>
<li><a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotation-Annotation.html#member-view"><code>view</code></a> &#x2013; The <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_view_annotationview-AnnotationView.html"><code>AnnotationView</code></a> instance.</li>
<li><a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotation-Annotation.html#member-type"><code>type</code></a> &#x2013; The type of the annotation.</li>
<li><a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_annotation-Annotation.html#member-isActive"><code>isActive</code></a> &#x2013; A property that determines if the annotation view and annotation inner views are active or not. It should be changed by the annotation UI when it changes the active annotation.</li>
</ul>
<p>The <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_sidebar-Sidebar.html"><code>Sidebar</code></a> class stopped operating on the global collection of annotations. From now on, the annotation UI that is responsible for displaying the sidebar should provide the sidebar with its collection of annotations and inform about possible actions with the new <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_sidebar-Sidebar.html#function-rearrange"><code>rearrange()</code></a> and <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_sidebar-Sidebar.html#function-refresh"><code>refresh()</code></a> methods.</p>
<p>The <a href="https://ckeditor.com/docs/ckeditor5/latest/api/module_comments_annotations_editorannotations-EditorAnnotations.html"><code>EditorAnnotations</code></a> started firing events instead of manipulating the global collection of annotations. From now on, every annotation UI needs to create its own integration with this class. This may change in the future as it complicates the implementation of the custom UI.</p>
<h2 id="code-migration-examples"><a class="headerlink" href="#code-migration-examples">#</a> Code migration examples</h2>
<h3 id="registering-and-activating-annotation-uis"><a class="headerlink" href="#registering-and-activating-annotation-uis">#</a> Registering and activating annotation UIs</h3>
<p>Before:</p>
<pre class="highlight"><code class="js">const annotations = editor.plugins.get( &apos;Annotations&apos; );

annotations.register( &apos;myCustomUI&apos;, myCustomUI );
annotations.switchTo( &apos;myCustomUI&apos; );

// Activate and deactivate the UI.
annotations.attach( &apos;myCustomUI&apos; );
annotations.detach( &apos;myCustomUI&apos; );
</code></pre>
<p>After:</p>
<pre class="highlight"><code class="js">const annotationsUIs = editor.plugins.get( &apos;AnnotationsUIs&apos; );

annotationsUIs.register( &apos;myCustomUI&apos;, myCustomUI );
annotationsUIs.switchTo( &apos;myCustomUI&apos; );

// Activate and deactivate the UI.
annotationsUIs.activate( &apos;myCustomUI&apos; );
annotationsUIs.deactivate( &apos;myCustomUI&apos; );

// Activate two different UIs for comments and suggestions.
annotationsUIs.activate( &apos;wideSidebar&apos;, annotation =&gt; annotation.type === &apos;comment&apos; );
annotationsUIs.activate( &apos;inline&apos;, annotation =&gt; annotation.type !== &apos;comment&apos; );
annotationsUIs.deactivateAll();
</code></pre>
<h3 id="using-global-collection-of-annotations-and-active-annotations"><a class="headerlink" href="#using-global-collection-of-annotations-and-active-annotations">#</a> Using  global collection of annotations and active annotations</h3>
<p>Before:</p>
<pre class="highlight"><code class="js">const annotations = editor.plugins.get( &apos;Annotations&apos; );

// An annotation view or `null`.
const activeAnnotationView = annotations.activeView;

// A collection of annotation views.
const annotationViewCollection = annotations.items;

// Adding an annotation to the collection.
const target = new Rect( { left: 0, top: 0 } );
annotations.add( innerView, target );

// Removing an annotation based on the inner view.
annotations.remove( innerView );
</code></pre>
<p>After:</p>
<pre class="highlight"><code class="js">const annotations = editor.plugins.get( &apos;Annotations&apos; );

// A set of active annotations.
const activeAnnotations = annotations.activeAnnotations;

// An array of active annotation views.
Array.from( activeAnnotations, annotation =&gt; annotation.view );

// A collection of annotations (`Annotation` class items).
const annotationCollection = annotations.collection;

// Adding an annotation to the collection.
annotations.add( new Annotation( {
    view: new AnnotationView( innerView ),
    target: new Rect( { left: 0, top: 0 } ),
    type: &apos;comment&apos; // The type is used only for the AnnotationsUIs filtering mechanism.
} ) );

// Removing an annotation based on the inner view.
const annotation = annotations.getByInnerView( innerView );
annotations.remove( annotation );
</code></pre>
<h3 id="creating-a-custom-annotations-ui"><a class="headerlink" href="#creating-a-custom-annotations-ui">#</a> Creating a custom Annotations UI</h3>
<p>Before:</p>
<pre class="highlight"><code class="js">class CustomAnnotationUI {
    attach() {
        const annotations = this.editor.plugins.get( &apos;Annotations&apos; );

        // The code responsible for displaying annotations
        // based on the global collection of annotations.
    }

    detach() {
        // The code responsible for hiding the UI and detaching
        // listeners from the global annotation collection.
    }
}
</code></pre>
<p>After:</p>
<pre class="highlight"><code class="js">class CustomAnnotationUI extends ContextPlugin {
    constructor() {
        this.set( &apos;activeAnnotation&apos;, null );
    }

    setActiveAnnotation( annotation ) {
        // The code responsible for reacting to annotation changes.
        if ( annotation === this.activeAnnotation ) {
            return;
        }

        if ( this.activeAnnotation ) {
            this.activeAnnotation.isActive = false;
        }

        if ( annotation ) {
            annotation.isActive = true;
        }

        this.activeAnnotation = annotation;
    }

    attach( annotations ) {
        // The code responsible for displaying annotations
        // based on the annotation collection passed to this UI.

        // The code responsible for setting an active and non-active annotation
        // based on the annotation focus changes.
        this.listenTo( annotations, &apos;focus&apos;, ( evt, annotation ) =&gt; {
            this.setActiveAnnotation( annotation );
        } );

        this.listenTo( annotations, &apos;blur&apos;, () =&gt; {
            this.setActiveAnnotation( null );
        } );

        // The code responsible for the integration with editor annotation markers,
        // editor events and the editor selection changes.
        // The requirement of this integration might change in the future.
        // If the plugin was initialized as an editor plugin, the integration
        // should look like the following:
        const editorAnnotations = editor.plugins.get( &apos;EditorAnnotations&apos; );

        this.listenTo( editorAnnotations, &apos;refresh&apos;, () =&gt; refreshActiveAnnotation.bind( this ) );
        this.listenTo( editorAnnotations, &apos;blur&apos; ( evt, { isAnnotationTracked } ) =&gt; {
            if ( this.activeAnnotation &amp;&amp; isAnnotationTracked( this.activeAnnotation ) ) {
                this.setActiveAnnotation( null );
            }
        } );
        this.listenTo( editorAnnotations, &apos;uiUpdate&apos; () =&gt; annotations._refreshPositioning();

        function refreshActiveAnnotation() {
            const selectedAnnotations = editorAnnotations.getOrderedSelectedAnnotations( {
                annotations: this._annotations,
                activeAnnotation: this.activeAnnotation
            } );

            this.setActiveAnnotation( selectedAnnotations[ 0 ] || null );
        }
    }

    detach() {
        // The code responsible for hiding the UI and detaching
        // listeners from the annotation collection, editor annotations and others.
    }
}
</code></pre>

        </div>
      </section>
      <div class="side-navigation">
        <div class="side-navigation__wrapper">
          <nav class="side-navigation__inner">
            <ul class="tree guide-tree">
                          <li>
                            <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Guides</span></div>
                            <ul class="tree__item-nested-list">
                                    <li><a href="../overview.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span></div></a></li>
                                    <li><a href="../whats-new.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">What's new?</span></div></a></li>
                                    <li><a href="../quick-start.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Quick start</span></div></a></li>
                                    <li><a href="../faq.html">
                                        <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">FAQ</span></div></a></li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Integration</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../integration/installation.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Installation</span></div></a></li>
                                              <li><a href="../integration/basic-api.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Basic API</span></div></a></li>
                                              <li><a href="../integration/configuration.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Configuration</span></div></a></li>
                                              <li><a href="../integration/saving-data.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting and saving data</span></div></a></li>
                                              <li><a href="../integration/installing-plugins.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Installing plugins</span></div></a></li>
                                              <li><a href="../integration/advanced-setup.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Advanced setup</span></div></a></li>
                                              <li><a href="../integration/csp.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Content Security Policy</span></div></a></li>
                                              <li><a href="../integration/content-styles.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Content styles</span></div></a></li>
                                              <li><a href="../integration/features-html-output-overview.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Features' HTML output</span></div></a></li>
                                              <li>
                                                <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Frameworks</span></div>
                                                <ul class="tree__item-nested-list">
                                                        <li><a href="../integration/frameworks/overview.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Overview</span></div></a></li>
                                                        <li><a href="../integration/frameworks/angular.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Angular component</span></div></a></li>
                                                        <li><a href="../integration/frameworks/react.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">React component</span></div></a></li>
                                                        <li><a href="../integration/frameworks/vuejs-v2.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Vue.js 2.x component</span></div></a></li>
                                                        <li><a href="../integration/frameworks/vuejs-v3.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Vue.js 3+ component</span></div></a></li>
                                                        <li><a href="../integration/frameworks/css.html">
                                                            <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">CSS frameworks</span></div></a></li>
                                                </ul>
                                              </li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Development</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../development/custom-builds.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Custom builds</span></div></a></li>
                                              <li><a href="../development/plugins.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Plugins</span></div></a></li>
                                              <li><a href="../development/dll-builds.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">DLL builds</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Migration</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="migration-to-29.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration to v29.x</span></div></a></li>
                                              <li><a href="migration-to-27.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration to v27.x</span></div></a></li>
                                              <li><a href="migration-to-26.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration to v26.x</span></div></a></li>
                                              <li><a href="">
                                                  <div class="tree__item__wrapper tree__item__wrapper--active"><span class="tree__item--guide tree__item__text">Migration to v25.x</span></div></a></li>
                                              <li><a href="migration-from-ckeditor-4.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Migration from CKEditor 4</span></div></a></li>
                                      </ul>
                                    </li>
                                    <li>
                                      <div class="tree__item__wrapper"><span class="tree__item--folder tree__item__text">Support</span></div>
                                      <ul class="tree__item-nested-list">
                                              <li><a href="../support/browser-compatibility.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Browser compatibility</span></div></a></li>
                                              <li><a href="../support/license-and-legal.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">License and legal</span></div></a></li>
                                              <li><a href="../support/getting-support.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Getting support</span></div></a></li>
                                              <li><a href="../support/reporting-issues.html">
                                                  <div class="tree__item__wrapper"><span class="tree__item--guide tree__item__text">Reporting issues</span></div></a></li>
                                      </ul>
                                    </li>
                            </ul>
                          </li>
            </ul>
          </nav>
        </div>
      </div>
    </main>
    <footer class="footer footer--bordered">
      <p>&copy; 2003-2021 <a href="http://cksource.com" target="_blank" rel="noopener">CKSource</a>. All rights reserved.</p>
    </footer>
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
docsearch({
apiKey:'fc463c26455365ad403d5ec51796cd73',indexName:'ckeditor_nightly',inputSelector:'#docsearch_input',algoliaOptions:{hitsPerPage:250,attributesToRetrieve:'*',facetFilters:['tags: ckeditor5']},
transformData: function( hits ) {var sortingFn = function( a, b ) {a.custom_ranking = a.custom_ranking || 0;b.custom_ranking = b.custom_ranking || 0;if ( a.custom_ranking === b.custom_ranking ) return a.index - b.index;if ( a.custom_ranking > b.custom_ranking ) return -1;if ( a.custom_ranking < b.custom_ranking ) return 1;};var result = [];var tags = [ 'builds', 'framework', 'examples', 'features', 'api' ];var hitsGrouped = { api: [] };hitsGrouped[ 'builds' ] = hits.filter( function( h ) {return h.tags.includes( 'builds' );} ).slice( 0, 7 ).map( function( item, idx ) {item.index = idx;return item;} ).sort( sortingFn );tags.forEach( function( tag ) {if ( tag !== 'builds' ) {hitsGrouped[ tag ] = hits.filter( function( h ) {return h.tags.includes( tag );} ).slice( 0, 10 ).map( function( item, idx ) {item.index = idx;return item;} ).sort( sortingFn ).slice( 0, 3 );}} );var apiSearchHits = [];if ( window.apiSearch ) apiSearchHits = window.apiSearch();hitsGrouped.api = hitsGrouped.api.filter( function( h ) {var isDuplicated = false;for ( var i = 0; i < apiSearchHits.length; i++ ) {if ( h.url.includes( apiSearchHits[ i ].urlShort ) ) {isDuplicated = true;break;}}return !isDuplicated;} );hitsGrouped.api = ( apiSearchHits || [] ).concat( hitsGrouped.api );result = result.concat( hitsGrouped[ 'builds' ] );tags.forEach( function( tag ) {if ( tag !== 'builds' ) result = result.concat( hitsGrouped[ tag ].slice( 0, 4 ) );} );return result;}
});
</script>
  </body>
</html>