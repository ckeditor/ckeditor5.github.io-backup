/*!
 * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=519)}({155:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={tokenUrl:"https://33333.cke-cs.com/token/dev/ijrDsqFix838Gh3wGO3F77FSW94BwcLXprJ4APSp3XQ26xsUHTi0jcb1hoBt",uploadUrl:"https://33333.cke-cs.com/easyimage/upload/"}},519:function(e,t,i){"use strict";i.r(t);var n=i(155);const r=(e,{writer:t})=>{const i=t.createElement("sideCard"),n=(e=>{for(const t of["default","alternate"])if(e.hasClass("side-card-"+t))return t;return"default"})(e);t.setAttribute("cardType",n,i);const r=[...e.getChildren()].find(e=>e.is("element","div")&&e.hasClass("side-card-url"));return r&&t.setAttribute("cardURL",r.getChild(0).data,i),i},d=(e,t,i,n)=>{const r=i.ownerDocument,d=createElement(r,"button",{},[e]);return d.addEventListener("click",()=>{n.model.change(t)}),i.appendChild(d),d},s=(e,{asWidget:t})=>(i,{writer:n,consumable:r,mapper:s})=>{const a=i.getAttribute("cardType")||"default",o=n.createContainerElement("aside",{class:"side-card side-card-"+a});for(const e of i.getChildren()){const i=n.createEditableElement("div");e.is("element","sideCardTitle")?n.addClass("side-card-title",i):n.addClass("side-card-section",i),r.consume(e,"insert"),s.bindElements(e,i),t&&toWidgetEditable(i,n),n.insert(n.createPositionAt(o,"end"),i)}const c=i.getAttribute("cardURL");if(c){const e=n.createRawElement("div",{class:"side-card-url"},(function(e){e.innerText=`URL: "${c}"`}));n.insert(n.createPositionAt(o,"end"),e)}if(t){const t=n.createRawElement("div",{class:"side-card-actions",contenteditable:"false","data-cke-ignore-events":"true"},((e,t)=>function(i){d("Set URL",e=>{const i=prompt("Set URL",t.getAttribute("cardURL")||"");e.setAttribute("cardURL",i,t)},i,e);const n="default"===t.getAttribute("cardType")?"alternate":"default";d("Change type",e=>{e.setAttribute("cardType",n,t)},i,e);const r=t.childCount,s=d("Add section",e=>{e.insertElement("sideCardSection",t,"end")},i,e);r>4&&s.setAttribute("disabled","disabled");const a=d("Remove section",e=>{e.remove(t.getChild(r-1))},i,e);r<3&&a.setAttribute("disabled","disabled")})(e,i));n.insert(n.createPositionAt(o,"end"),t),toWidget(o,n,{widgetLabel:"Side card",hasSelectionHandle:!0})}return o};class a extends Command{refresh(){const e=this.editor.model,t=findOptimalInsertionPosition(e.document.selection,e);this.isEnabled=e.schema.checkChild(t,"sideCard")}execute(){const e=this.editor.model,t=e.document.selection,i=findOptimalInsertionPosition(t,e);e.change(t=>{const n=t.createElement("sideCard",{cardType:"default"}),r=t.createElement("sideCardTitle"),d=t.createElement("sideCardSection"),s=t.createElement("paragraph");t.insert(r,n,0),t.insert(d,n,1),t.insert(s,d,0),e.insertContent(n,i),t.setSelection(t.createPositionAt(r,0))})}}class o extends Plugin{constructor(e){super(e),this._defineSchema(),this._defineConversion(),e.commands.add("insertCard",new a(e)),this._defineUI()}_defineConversion(){const e=this.editor,t=e.conversion;t.for("upcast").elementToElement({view:{name:"aside",classes:["side-card"]},model:r}).elementToElement({view:{name:"div",classes:["side-card-title"]},model:"sideCardTitle"}).elementToElement({view:{name:"div",classes:["side-card-section"]},model:"sideCardSection"}),t.for("editingDowncast").elementToElement({model:"sideCard",view:s(e,{asWidget:!0}),triggerBy:{attributes:["cardType","cardURL"],children:["sideCardSection"]}}),t.for("dataDowncast").elementToElement({model:"sideCard",view:s(e,{asWidget:!1})})}_defineSchema(){const e=this.editor.model.schema;e.register("sideCard",{allowWhere:"$block",isObject:!0,allowAttributes:["cardType","cardURL"]}),e.addChildCheck((e,t)=>{if([...e.getNames()].includes("sideCard")&&"sideCard"===t.name)return!1}),e.register("sideCardTitle",{isLimit:!0,allowIn:"sideCard"}),e.extend("$text",{allowIn:"sideCardTitle"}),e.addAttributeCheck(e=>{if(e.endsWith("sideCardTitle $text"))return!1}),e.register("sideCardSection",{isLimit:!0,allowIn:"sideCard",allowContentOf:"$root"})}_defineUI(){const e=this.editor;e.ui.componentFactory.add("insertCard",t=>{const i=new ButtonView(t),n=e.commands.get("insertCard");return i.set({withText:!0,icon:!1,label:"Insert card"}),i.bind("isEnabled").to(n),i.on("execute",()=>{e.execute("insertCard"),e.editing.view.focus()}),i})}}ClassicEditor.create(document.querySelector("#editor-element-reconversion"),{cloudServices:n.a,extraPlugins:[o],image:{toolbar:["imageStyle:full","imageStyle:side","|","imageTextAlternative"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},toolbar:{items:["heading","|","bold","italic","|","insertCard"],viewportTopOffset:window.getViewportTopOffsetConfig()}}).then(e=>{window.editor=e}).catch(e=>{console.error(e)})}});